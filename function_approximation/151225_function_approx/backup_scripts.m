
%%% spline
%  [net, info] = poly_run_resNet('networkType','dagnn','resNet_n',3,'expDir','~/vlfeat_exp/resNet/poly_resNet_n_3_addSum_spline','dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',@cnn_net2resNet_addSumLayer,'gpus',[1],'nonlinearity',struct('type','spline','k',5))
%  [net, info] = poly_run_resNet('networkType','dagnn','resNet_n',3,'expDir','~/vlfeat_exp/resNet/poly_resNet_n_3_addSum_spline_k_1','dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',@cnn_net2resNet_addSumLayer,'gpus',[1],'nonlinearity',struct('type','spline','k',1))
% nVar = 4; nOrder = 10; hiddenLayers = [5];  [net, info] = poly_run_resNet('networkType','dagnn','resNet_n',3,'expDir',['~/vlfeat_exp/resNet/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_addSum'],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',@cnn_net2resNet_addSumLayer,'gpus',[3],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]/10) --------- obsolete

% nVar = 4; nOrder = 6; hiddenLayers = [100 100];  density = 0.1;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density)],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.01,'density',density,'networkType','simplenn','useBatchNorm',false);
% nVar = 3; nOrder = 3; hiddenLayers = [10];  density = 0.1;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density)],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',false);

%% polyGen
% nVar = 3; nOrder = 3; hiddenLayers = [20];  density = 0.1; poly_eval_func = @poly_eval_n3_d3_v01;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',false,'poly_eval_func',poly_eval_func); % --- works

% nVar = 3; nOrder = 3; hiddenLayers = [120]; force_batchSize = 100; useBatchNorm = false; density = 0.2; poly_eval_func = @poly_eval_n3_d3_v04_d6;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[1],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); 

% nVar = 3; nOrder = 2; hiddenLayers = [120]; force_batchSize = 100; useBatchNorm = false; density = 0.2; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); %--- works

% nVar = 3; nOrder = 2; hiddenLayers = [30]; force_batchSize = 100; useBatchNorm = false; density = 0.2; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- [30] is worse than [15 15] ?

% nVar = 3; nOrder = 2; hiddenLayers = [15 15]; force_batchSize = 100; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[1],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','relu','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- [30] is worse than [15 15] ?

% nVar = 3; nOrder = 2; hiddenLayers = [1]; force_batchSize = 100; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_n3_d3_v05_extra_power2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[1],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity','absSquare','learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','dagnn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- square, the same architecture

% nVar = 3; nOrder = 2; hiddenLayers = [1 1]; force_batchSize = 100; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_n3_d3_v05_extra_power4; nonlinearity = struct('type','absSquare');  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) '_' nonlinearity.type  ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[1],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity', nonlinearity.type,'learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.000003,'density',density,'networkType','dagnn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize,'momentum',0,'weightDecay',0); % --- square, the same architecture

% nVar = 1; nOrder = 4; hiddenLayers = [10 10]; force_batchSize = 100; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_n1_power2_noBias; nonlinearity = struct('type','relu');  [net, info, imdb] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) '_' nonlinearity.type  ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[1],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity', nonlinearity.type,'learningRate', [0.05*ones(1,5)]*0.01,'density',density,'networkType','dagnn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize,'momentum',0.9,'weightDecay',0); % --- square, the same architecture



%% spline
% nVar = 3; nOrder = 2; hiddenLayers = [30]; force_batchSize = 100; splineK = 5; useBatchNorm = false; density = 0.2; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) '_splineK_' num2str(splineK) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity', struct('type','spline','k', splineK) ,'learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- [30] is worse than [15 15] ?

% nVar = 3; nOrder = 2; hiddenLayers = [84]; force_batchSize = 100; splineK = 5; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) '_splineK_' num2str(splineK) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity', struct('type','spline','k', splineK) ,'learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*0.1,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- [30] is worse than [15 15] ?

% nVar = 5; nOrder = 3; hiddenLayers = [30]; force_batchSize = 100; splineK = 5; useBatchNorm = false; density = 1; poly_eval_func = @poly_eval_general_2;  [net, info] = poly_run_resNet('expDir',['~/vlfeat_exp/resNet/poly/poly_hidden_' num_array_to_string_separated_by_underscore(hiddenLayers) '_nVar_' num2str(nVar) '_nOrder_' num2str(nOrder)  '_density_' num2str(density) '_' func2str(poly_eval_func) '_batchSize_' num2str(force_batchSize) '_bn_' num2str(useBatchNorm) '_splineK_' num2str(splineK) ],'dataDir','~/vlfeat_exp/matconvnet_data/cifar/','replaceFunc',[],'gpus',[2],'nVar',nVar,'nOrder',nOrder,'hiddenLayers',hiddenLayers,'nonlinearity', struct('type','spline','k', splineK) ,'learningRate', [0.05*ones(1,30) 0.005*ones(1,10) 0.0005*ones(1,5)]*100,'density',density,'networkType','simplenn','useBatchNorm',useBatchNorm,'poly_eval_func',poly_eval_func,'force_batchSize',force_batchSize); % --- [30] is worse than [15 15] ?
